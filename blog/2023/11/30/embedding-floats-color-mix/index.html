<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>This month in Servo: better floats, color-mix(), try job labels, and more! - Servo, the embeddable, independent, memory-safe, modular, parallel web rendering engine</title>
  <meta property="og:title" content="This month in Servo: better floats, color-mix(), try job labels, and more! - Servo, the embeddable, independent, memory-safe, modular, parallel web rendering engine">
  

  
  <meta name="description" content="Sneak peek into our embedding effort, changes to pull requests, plus nightly updates to browser UI, floats, inline layout, CSS, and tooling.">
  <meta name="og:description" content="Sneak peek into our embedding effort, changes to pull requests, plus nightly updates to browser UI, floats, inline layout, CSS, and tooling.">
  
  <meta name="keywords" content="servo, servo engine, servo rendering engine, web engine, web rendering engine, web browser, web browser engine, rust">
  <meta name="author" content="The Servo Project Developers">

  <meta property="og:site_name" content="Servo">
  <meta property="og:type" content="website">
  <meta property="og:image" content="/img/servo-color-positive.png">
  <meta property="og:image:alt" content="Servo logo">
  <meta property="og:logo" content="/img/servo-symbol-color-no-container.png">
  <meta property="og:url" content="/blog/2023/11/30/embedding-floats-color-mix/">

  <link rel="stylesheet" href="/css/style.css">
  <link rel="shortcut icon" href="/img/servo-symbol-color-no-container.png">
  <link href="https://unpkg.com/prismjs@1.20.0/themes/prism-okaidia.css" rel="stylesheet">
  <link rel="alternate" href="/blog/feed.xml" title="Servo Blog" type="application/atom+xml">
</head>

  <body class="is-page">
    <main class="is-main">
      <nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">
        <img src="/img/servo-color-negative-no-container.png" alt="This month in Servo: better floats, color-mix(), try job labels, and more!">
      </a>

      <a role="button" class="navbar-burger" data-target="navbar-menu" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

    <div class="navbar-menu" id="navbar-menu">
      
        
        
          
          <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link
            
              
            
              
            
              
            
              
            
          " href="#">
              Get Involved
            </a>
            <div class="navbar-dropdown">
              
                <a class="navbar-item" href="/contributing/">
                  Contributing
                </a>
              
                <a class="navbar-item" href="https://book.servo.org" target="_blank">
                  Servo Book
                </a>
              
                <a class="navbar-item" href="https://wpt.servo.org/" target="_blank">
                  WPT pass rates
                </a>
              
                <a class="navbar-item" href="/coc/">
                  Code of Conduct
                </a>
              
            </div>
          </div>
        
      
        
        
          <a class="navbar-item" href="/download/">
            Download
          </a>
        
      
        
        
          <a class="navbar-item" href="/blog/">
            Blog
          </a>
        
      
        
        
          <a class="navbar-item" href="https://demo.servo.org/" target="_blank">
            Demos
          </a>
        
      
        
        
          
          <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link
            
              
            
              
            
              
            
              
            
          " href="#">
              About
            </a>
            <div class="navbar-dropdown">
              
                <a class="navbar-item" href="/about/">
                  About Servo
                </a>
              
                <a class="navbar-item" href="/governance/">
                  Governance
                </a>
              
                <a class="navbar-item" href="/sponsorship/">
                  Sponsorship
                </a>
              
                <a class="navbar-item" href="/acknowledgements/">
                  Acknowledgements
                </a>
              
            </div>
          </div>
        
      
      <div class="navbar-end">
  <div class="navbar-item buttons has-addons">
    
      <a class="button is-github-color" title="GitHub" href="https://github.com/servo/servo">
        <span class="icon"><i class="fab fa-github"></i></span>
      </a>
    
      <a class="button is-mastodon-color" title="Mastodon" href="https://floss.social/@servo" rel="me">
        <span class="icon"><i class="fab fa-mastodon"></i></span>
      </a>
    
      <a class="button is-bluesky-color" title="Bluesky" href="https://bsky.app/profile/servo.org">
        <span class="icon"><i class="fab fa-bluesky"></i></span>
      </a>
    
      <a class="button is-twitter-color" title="Twitter" href="https://twitter.com/ServoDev">
        <span class="icon"><i class="fab fa-twitter"></i></span>
      </a>
    
      <a class="button is-linkedin-color" title="LinkedIn" href="https://www.linkedin.com/company/servo-project/">
        <span class="icon"><i class="fab fa-linkedin"></i></span>
      </a>
    
  </div>
</div>

    </div>
  </div>
</nav>

      <section class="section" style="padding-top: 0;">
        <div class="container">
          <aside class="menu box">
            <p class="menu-label">
              This month in Servo: better floats, color-mix(), try job labels, and more!
            </p>
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
          </aside>
          <div class="content">
            
<h1 class="title">This month in Servo: better floats, color-mix(), try job labels, and more!</h1>
<p class="subtitle"><span class="tag is-dark">2023-11-30</span> Sneak peek into our embedding effort, changes to pull requests, plus nightly updates to browser UI, floats, inline layout, CSS, and tooling.</p>

<div class="has-top-margin">
  <aside class="_correction">
<p><strong>Correction (2023-12-04)</strong></p>
<p><a href="https://github.com/servo/servo.org/pull/126">An earlier version</a> of this post said that Servo now supports the <strong>:has() selector</strong>, but this was incorrect.
While some of the code implementing the feature has landed, it is <a href="https://github.com/servo/servo/blob/7bcb25c85c98c367c6423ebc0fed964dd08cad56/components/selectors/parser.rs#L276-L279">not yet enabled</a>.</p>
</aside>
<p>November has been another exciting month for Servo!</p>
<p>Our nightly example browser, servoshell, is now easier to navigate, <strong>accepting URLs without http:// or https://</strong> both in the location bar and on the command line (<a href="https://github.com/atbrakhi">@atbrakhi</a>, <a href="30148">#30148</a>), and should no longer lock up when run with <code>--no-minibrowser</code> (<a href="https://github.com/wusyong">@wusyong</a>, <a href="https://github.com/servo/servo/pull/30598">#30598</a>).
Local paths can also be given on the command line, and are still preferred when the path points to a file that exists.</p>
<p>Work is now underway to <a href="/blog/2023/10/26/css-filters-testing-tauri/#embeddable-web-engine">improve our embedding story</a> and prepare Servo for integration with <a href="https://tauri.app">Tauri</a>, starting with <strong>precompiled <a href="https://en.wikipedia.org/wiki/ANGLE_(software)">ANGLE</a></strong> for faster initial builds (<a href="https://github.com/atbrakhi">@atbrakhi</a>), better support for <strong>offscreen rendering</strong> (<a href="https://github.com/delan">@delan</a>, <a href="https://github.com/servo/servo/pull/30767">#30767</a>), and support for <strong>multiple webviews</strong> (<a href="https://github.com/delan">@delan</a>, <a href="https://github.com/servo/servo/pull/30648">#30648</a>).
These changes haven’t landed yet, but once they do, apps will be able to open, move, resize, and interleave Servo with other widgets.</p>
<figure class="_fig">
<div class="_flex">
    <a href="/img/blog/servoshell-mdi.png"><img src="/img/blog/servoshell-mdi.png"
        alt="servoshell with a multiple-document interface, showing three overlapping egui windows of different sizes inside a native window"></a>
</div>
<figcaption>
<p>A very early prototype of a Servo-based multiple-document interface (<a href="https://github.com/delan">@delan</a>, <a href="https://github.com/servo/servo/pull/30785">#30785</a>), taking advantage of upcoming embedding improvements to interleave Servo with <a href="https://www.egui.rs">egui</a> windows.</p>
</figcaption>
</figure>
<h2 id="floats-and-inline-layout" tabindex="-1">Floats and inline layout <a class="header-anchor" href="#floats-and-inline-layout">
        <span class="icon hashlink"><i class="fas fa-link"></i></span>
      </a></h2>
<p>We’ve made several improvements to Servo’s inline layout system, which handles the flow and wrapping of text, images, and inline blocks, delivering welcome bumps to our <a href="/blog/2023/07/20/servo-web-platform-tests/">WPT</a> pass rates (<a href="https://github.com/mrobinson">@mrobinson</a>, <a href="https://github.com/Loirooriol">@Loirooriol</a>, <a href="https://github.com/mukilan">@mukilan</a>):</p>
<ul>
<li>61.4% in the CSS2 <code>linebox</code> test suite (+2.8pp), with better handling of line heights and forced line breaks (<a href="https://github.com/servo/servo/pull/30519">#30519</a>)</li>
<li>78.9% in <code>floats</code> (+1.0pp) and 73.3% in <code>floats-clear</code> (+0.5pp), by allowing trailing whitespace to overlap with floats (<a href="https://github.com/servo/servo/pull/30586">#30586</a>)</li>
<li>78.1% in <code>normal-flow</code> (+1.1pp), by fixing inlines split by boxes and paving the way for fragments that span boxes (<a href="https://github.com/servo/servo/pull/30608">#30608</a>)</li>
<li>82.2% in <code>floats</code> (a further +3.3pp), by fixing the fragmentation of unbreakable fragments that span multiple boxes (<a href="https://github.com/servo/servo/pull/30628">#30628</a>)</li>
</ul>
<h2 id="css-updates" tabindex="-1">CSS updates <a class="header-anchor" href="#css-updates">
        <span class="icon hashlink"><i class="fas fa-link"></i></span>
      </a></h2>
<p>Several components and dependencies have been upgraded, the biggest being <strong>Stylo</strong>, our Rust-based CSS engine that is now part of Firefox.
We’ve caught up with upstream Stylo by 311 commits, bringing our CSS support from August 2022 to June 2023 (<a href="https://github.com/Loirooriol">@Loirooriol</a>, <a href="https://github.com/mrobinson">@mrobinson</a>, <a href="https://github.com/servo/servo/pull/30646">#30646</a>, <a href="https://github.com/servo/servo/pull/30681">#30681</a>, <a href="https://github.com/servo/servo/pull/30692">#30692</a>, <a href="https://github.com/servo/servo/pull/30748">#30748</a>, <a href="https://github.com/servo/servo/pull/30770">#30770</a>), and bumped <strong>cssparser</strong> to 0.31.2 (<a href="https://github.com/Loirooriol">@Loirooriol</a>, <a href="https://github.com/servo/servo/pull/30771">#30771</a>).</p>
<p>As a result, Servo now passes 60.5% of the CSSOM test suite (+3.3pp).
We also no longer incorrectly transition properties that are inherently “discrete” (<a href="https://github.com/Loirooriol">@Loirooriol</a>, <a href="https://github.com/servo/servo/pull/30565">#30565</a>), passing a further (net) 294 test cases.</p>
<p>Thanks to the recent work on Stylo by Mozilla and others, Servo now supports <strong>color-mix()</strong> and the <strong>new color spaces</strong> from <a href="https://drafts.csswg.org/css-color-4/">CSS Color 4</a> (<a href="https://github.com/Loirooriol">@Loirooriol</a>, <a href="https://github.com/servo/servo/pull/30752">#30752</a>)!
These new color features allow authors to:</p>
<ul>
<li>select colors from wider gamuts than in sRGB (<code>display-p3</code>, <code>a98-rgb</code>, <code>prophoto-rgb</code>, <code>rec2020</code>)</li>
<li>mix colors as if mixing intensities of colored light in real life (<code>srgb-linear</code>, <code>xyz</code>)</li>
<li>select a variety of colors with consistent perceived lightness (<code>oklab</code>, <code>lab</code>)</li>
<li>select colors with consistent perceived lightness and hue (<code>oklch</code>, <code>lch</code>)</li>
</ul>
<figure class=_fig>
<iframe src="https://bucket.daz.cat/work/igalia/servo/5.html" id="_color_mix_demo"></iframe>
<figcaption>
<p>The results of mixing <code>lime</code> and <code>blue</code> in a variety of CSS color spaces, based on <a href="https://codepen.io/web-dot-dev/full/MWBXVLV">a demo</a> from <a href="https://developer.chrome.com/articles/css-color-mix/">this post</a>. The background color is the same as this blog post mixed with 10% white, or <code>color-mix(in oklch, #121619, white 10%)</code>.</p>
</figcaption>
</figure>
<h2 id="dependency-upgrades" tabindex="-1">Dependency upgrades <a class="header-anchor" href="#dependency-upgrades">
        <span class="icon hashlink"><i class="fas fa-link"></i></span>
      </a></h2>
<p>Our upgrade efforts also affect the tooling Servo uses.
Servo now builds on Ubuntu 22.04 (<a href="https://github.com/mukilan">@mukilan</a>, <a href="https://github.com/servo/servo/pull/30162">#30162</a>) and macOS 13 on CI, which in turn has made upgrading LLVM and Python (for mach) more urgent.
As a result, we’ve started upgrading Python from 3.10 to 3.12 (<a href="https://github.com/mrobinson">@mrobinson</a>, <a href="https://github.com/mukilan">@mukilan</a>, <a href="https://github.com/sagudev">@sagudev</a>, <a href="https://github.com/servo/servo/pull/30638">#30638</a>, <a href="https://github.com/servo/servo/pull/30645">#30645</a>, <a href="https://github.com/servo/servo/pull/30659">#30659</a>, <a href="https://github.com/servo/servo/pull/30685">#30685</a>).</p>
<p>But the biggest impact on our ability to keep our dependencies up to date comes from our <strong>Rust version</strong>.
Many pre-version-1 libraries, even in our transitive dependencies, bump their <abbr title="minimum supported Rust version">MSRV</abbr> quite aggressively, sometimes even requiring a nightly compiler.
First, we migrated from Rust nightly-2023-02-01 to nightly-03-18 (<a href="https://github.com/mrobinson">@mrobinson</a>, <a href="https://github.com/servo/servo/pull/30630">#30630</a>), which in turn allowed us to upgrade our network stack (<a href="https://github.com/mrobinson">@mrobinson</a>, <a href="https://github.com/servo/servo/pull/30612">#30612</a>, <a href="https://github.com/servo/servo/pull/30660">#30660</a>).
Since then, we’ve started eliminating our usage of unstable Rust features (<a href="https://github.com/mrobinson">@mrobinson</a>, <a href="https://github.com/servo/servo/pull/30745">#30745</a>, <a href="https://github.com/servo/servo/pull/30742">#30742</a>), which should make future Rust upgrades easier.</p>
<h2 id="pull-requests" tabindex="-1">Pull requests <a class="header-anchor" href="#pull-requests">
        <span class="icon hashlink"><i class="fas fa-link"></i></span>
      </a></h2>
<figure class="_figr"><a href="/img/blog/try-job-labels.png"><img src="/img/blog/try-job-labels.png"
    alt="GitHub pull request label menu, with the new try job labels (T-full, T-linux-wpt-2013, T-linux-wpt-2020, T-macos, T-windows)"></a></figure>
<p><span class="_floatmin"></span>You can now <strong>run try jobs by adding labels</strong> to your pull requests (<a href="https://github.com/mrobinson">@mrobinson</a>, <a href="https://github.com/servo/servo/pull/30383">#30383</a>, <a href="https://github.com/servo/servo/pull/30647">#30647</a>, <a href="https://github.com/servo/servo/pull/30650">#30650</a>, <a href="https://github.com/servo/servo/pull/30756">#30756</a>).
You can even add multiple labels!
The old method, where you mention <a href="https://github.com/bors-servo">@bors-servo</a> in a comment, has been removed (<a href="https://github.com/mrobinson">@mrobinson</a>, <a href="https://github.com/servo/servo/pull/30712">#30712</a>), making your pull requests less likely to get spammed with job failures when you post comments on them.
For more details, see <a href="https://book.servo.org/contributing.html">Contributing to Servo</a>.</p>
<h2 id="stability" tabindex="-1">Stability <a class="header-anchor" href="#stability">
        <span class="icon hashlink"><i class="fas fa-link"></i></span>
      </a></h2>
<p>We’ve fixed a panic when no font is found for a run of text, printing a warning instead (<a href="https://github.com/mrobinson">@mrobinson</a>, <a href="https://github.com/servo/servo/pull/30581">#30581</a>), as well as a panic when creating stacking contexts with zero scale (<a href="https://github.com/mrobinson">@mrobinson</a>, <a href="https://github.com/servo/servo/pull/30713">#30713</a>).
In general, Servo should never panic outside of debug assertions.</p>
<p>We’ve also fixed a bug where paint worklets may access thread-local storage after a script thread gets destroyed (<a href="https://github.com/mrobinson">@mrobinson</a>, <a href="https://github.com/servo/servo/pull/30671">#30671</a>), which caused intermittent panics in 74 tests.</p>
<style>
    /* guaranteed minimum width for first paragraph after a float */
    ._floatmin {
        display: block;
        width: 13em;
        overflow: hidden;
    }
    ._none {
        display: none;
    }
    ._fig:not(#specificity) {
        width: 33em;
        max-width: 100%;
        margin: 1em auto;
    }
    ._fig > ._flex {
        display: flex;
    }
    ._fig._min {
        width: min-content;
    }
    ._fig table {
        text-align: initial;
    }
    ._fig figcaption._notes {
        text-align: left;
        width: max-content;
        max-width: 100%;
    }
    ._figl:not(#specificity),
    ._figr:not(#specificity) {
        margin: 0 1em 1em;
    }
    ._figl {
        float: left;
    }
    ._figr {
        float: right;
    }
    .figl > iframe,
    .figr > iframe,
    .figl > a > img,
    .figr > a > img {
        width: 17em;
        max-width: max-content;
    }
    ._runin {
        margin-bottom: 1em;
    }
    ._runin > p,
    ._runin > h2 {
        display: inline;
    }
    #_color_mix_demo {
        margin: 0 auto;
        display: block;
        height: min(calc(100vh - 9em), 400px);
        width: min(100%, 33em);
    }
    ._correction {
        max-width: 33em;
        margin: 1em auto;
        border-bottom: 1px solid;
        padding-bottom: 1em;
    }
</style>

</div>

<div class="has-top-margin buttons has-addons">
  <a class="button" href="/blog/">Back</a>
</div>

          </div>
        </div>
      </section>
    </main>
    <footer class="footer">
  <div class="container" style="text-align: center;">
    <a href="/coc/">Code of Conduct</a> |
    Contact: <a href="mailto:info@servo.org">info@servo.org</a>,
    <a href="https://servo.zulipchat.com/">Zulip Chat</a>,
    <a href="https://github.com/servo/servo/discussions">GitHub Discussions</a>,
    <a href="https://floss.social/@servo">Mastodon</a>,
    <a href="https://bsky.app/profile/servo.org">Bluesky</a>,
    <a href="https://twitter.com/ServoDev">Twitter</a>,
    <a href="https://www.linkedin.com/company/servo-project/">LinkedIn</a>
  </div>
  <div class="container" style="text-align: center; font-size: 0.875em;">
    <p><a href="https://linuxfoundation.eu"><img src="/img/lf-europe-logo.png" alt="Linux Foundation Europe logo" width="250" style="margin: 1em;"></a></p>
    <p>&copy; 2024 The Servo Project Developers</p>
    <p>Copyright &copy; Servo is a project of <a href="https://linuxfoundation.eu/">Linux Foundation Europe</a>.</p>
    <p>For website terms of use, trademark policy and other project policies please see <a href="https://lfprojects.org">https://lfprojects.org</a>.</p>
  </div>
</footer>
<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script>
  $(() => {
    const burger = $(".navbar-burger");
    const menu = $(".navbar-menu");
    burger.click(() => {
      [burger, menu].forEach((el) => el.toggleClass('is-active'));
    });
  });
</script>

  </body>
</html>
